(this.webpackJsonpspotifypartyfront=this.webpackJsonpspotifypartyfront||[]).push([[0],{51:function(e,t,a){e.exports=a(67)},56:function(e,t,a){},57:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(20),s=a.n(r),o=(a(56),a(11)),c=a(12),i=a(15),u=a(14),m=a(75),h=a(77),p=a(73),g=a(74),d=a(46),y=a(35);a(57),window.location.hash.substring(1).split("&").reduce((function(e,t){if(t){var a=t.split("=");e[a[0]]=decodeURIComponent(a[1])}return e}),{});window.location.hash="";a(58);var f=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this)).state={user:null},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){this.props.user!==this.state.user&&this.setState({user:this.props.user})}},{key:"render",value:function(){return l.a.createElement(m.a,{className:"topheader",bg:"light",expand:"lg"},l.a.createElement(m.a.Brand,{className:"brandLogo",href:"/"},"Spotify Party"),l.a.createElement(m.a.Toggle,{"aria-controls":"basic-navbar-nav"}),l.a.createElement(m.a.Collapse,{id:"basic-navbar-nav"},l.a.createElement(h.a,{className:"mr-auto"},l.a.createElement(h.a.Link,{href:"#home"},"Home"),l.a.createElement(h.a.Link,{href:"#link"},"Link")),null===this.state.user?l.a.createElement(h.a,{className:"ml-auto logintag"},l.a.createElement(h.a.Link,{href:"/login"},"Login with Spotify")):l.a.createElement(h.a,{className:"ml-auto"},l.a.createElement(p.a,{className:"myaccountTag",title:"My Account",id:"basic-nav-dropdown"},l.a.createElement(p.a.Item,{href:"#"},"Hello, ",this.state.user),l.a.createElement(p.a.Item,{href:"#"},"Preferences"),l.a.createElement(p.a.Divider,null),l.a.createElement(p.a.Item,{href:"#"},"Log out"))),l.a.createElement(g.a,{inline:!0,className:"searchButton"},l.a.createElement(d.a,{type:"text",placeholder:"Search",className:"mr-sm-2"}),l.a.createElement(y.a,{variant:"outline-success"},"Search"))))}}]),a}(l.a.Component),b=a(47),E=(a(63),a(76)),v=a(78),k=a(79),P=a(48),S=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleSelectedPlaylist=function(e){n.props.getplaylist(e)},n.handleInputChange=function(e){n.setState(Object(b.a)({},e.target.name,[e.target.value]))},n.handleAddPlaylistSubmit=function(e){e.preventDefault(),""!==e.target.newPlaylist.value&&fetch("/createplaylist",{method:"POST",body:JSON.stringify({newplaylist:"".concat(n.state.newPlaylist),relatedgroup:"".concat(e.target.newPlaylistGroup.value)}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){console.log("addplalist response:",e),null!==e&&(n.setState({newPlaylist:"",newPlaylistGroup:""}),console.log(n.state.newPlaylist))}))},n.handleAddGroupSubmit=function(e){e.preventDefault(),""!==e.target.newGroup.value&&fetch("/creategroup",{method:"POST",body:JSON.stringify({newgroup:"".concat(n.state.newGroup)}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){null!==e&&n.setState({newGroup:""})}))},n.handleAddMemberSubmit=function(e){e.preventDefault(),""!==e.target.newMember.value&&fetch("/addmember",{method:"POST",body:JSON.stringify({newMember:"".concat(n.state.newMember),relatedgroup:"".concat(e.target.newMemberGroup.value)}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){null!==e&&n.setState({newMember:"",newMemberGroup:""})}))},n.state={user:null,loggedIn:!1,getgroups:!1,groups:null,newPlaylist:"",newPlaylistGroup:"",newGroup:"",newMember:"",newMemberGroup:""},n}return Object(c.a)(a,[{key:"componentDidUpdate",value:function(){this.props.user!==this.state.user&&null!==this.props.user&&this.setState({user:this.props.user,loggedIn:!0,getgroups:!0}),(this.state.loggedIn=!0===this.state.getgroups)&&this.getAllgroups()}},{key:"getAllgroups",value:function(){var e=this;fetch("/getallgroups").then((function(t){return t.json().then((function(t){console.log("Res is: ",t),e.setState({groups:t,getgroups:!1})}))}))}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"fullsize"},null!==this.state.user?l.a.createElement("div",{className:"fullsize"},null!==this.state.groups?l.a.createElement(E.a,{defaultActiveKey:"0"},this.state.groups.map((function(t,a){return l.a.createElement(v.a,null,l.a.createElement(E.a.Toggle,{as:v.a.Header,eventKey:a},t.groupname),l.a.createElement(E.a.Collapse,{eventKey:a},l.a.createElement(v.a.Body,null,l.a.createElement("h4",null,"Members"),l.a.createElement("ul",null,t.members.map((function(e,t){return l.a.createElement("h6",null,e)}))),l.a.createElement(E.a,null,l.a.createElement(E.a.Toggle,{as:y.a,eventKey:3},"Add Member"),l.a.createElement(E.a.Collapse,{eventKey:3},l.a.createElement(v.a.Body,null,l.a.createElement("form",{onSubmit:e.handleAddMemberSubmit},l.a.createElement(g.a,{role:"form"},l.a.createElement(g.a.Group,null,l.a.createElement(g.a.Control,{name:"newMemberGroup",type:"hidden",value:e.state.groups[a].groupname}),l.a.createElement(g.a.Control,{onChange:e.handleInputChange,name:"newMember",type:"email",placeholder:"Enter email",value:e.state.newMember}),l.a.createElement(y.a,{className:"btnAddPlaylist",variant:"success",type:"submit"},"Add"))))))),l.a.createElement("h4",{className:"btnAddPlaylist"},"Playlists"),l.a.createElement("div",{id:"fixedspacing"},l.a.createElement("p",null)),l.a.createElement(k.a,{type:"radio",name:"playlists",vertical:!0,onChange:e.handleSelectedPlaylist},t.playlists.map((function(t,n){return l.a.createElement(P.a,{value:e.state.groups[a].playlists[n]},t[0])}))),l.a.createElement("div",{id:"fixedspacing"},l.a.createElement("p",null)),l.a.createElement(E.a,null,l.a.createElement(E.a.Toggle,{as:y.a,eventKey:2},"Create Playlist"),l.a.createElement(E.a.Collapse,{eventKey:2},l.a.createElement(v.a.Body,null,l.a.createElement("form",{onSubmit:e.handleAddPlaylistSubmit},l.a.createElement(g.a,{role:"form"},l.a.createElement(g.a.Group,null,l.a.createElement(g.a.Control,{name:"newPlaylistGroup",type:"hidden",value:e.state.groups[a].groupname}),l.a.createElement(g.a.Control,{onChange:e.handleInputChange,name:"newPlaylist",type:"text",placeholder:"Enter name",value:e.state.newPlaylist}),l.a.createElement(y.a,{className:"btnAddPlaylist",variant:"success",type:"submit"},"Create"))))))))))}))):l.a.createElement("div",null),l.a.createElement(E.a,null,l.a.createElement(E.a.Toggle,{as:v.a.Header,eventKey:1},"Create Group"),l.a.createElement(E.a.Collapse,{eventKey:1},l.a.createElement(v.a.Body,null,l.a.createElement("form",{onSubmit:this.handleAddGroupSubmit},l.a.createElement(g.a,null,l.a.createElement(g.a.Group,null,l.a.createElement(g.a.Control,{onChange:this.handleInputChange,name:"newGroup",type:"text",placeholder:"Enter name",value:this.state.newGroup})),l.a.createElement(y.a,{variant:"success",type:"submit"},"Create"))))))):l.a.createElement("h4",null,"Not logged in"))}}]),a}(l.a.Component),w=(a(64),a(72)),N=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).getTrackInfos=function(e){fetch("/gettracksinfo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json().then((function(e){console.log("Fetched tracks info:",e);var t=[];e.map((function(e,a){t[a]=[e.name,e.artists[0].name,e.album.name,"".concat(Math.floor(e.duration_ms/6e4).toFixed(0),":").concat((e.duration_ms/1e3%60).toFixed(0)),e.uri]})),console.log("Tracks:",t),n.setState({tracklist:t,nextup:t[0]})}))}))},n.state={playlist:null,playlistname:null,tracklist:[],nextup:[]},n}return Object(c.a)(a,[{key:"componentDidUpdate",value:function(){if(this.state.playlist!==this.props.playlist){var e=[];this.props.playlist.map((function(t,a){a>0&&(e[a-1]=t)})),this.setState({playlist:this.props.playlist}),this.getTrackInfos(e)}}},{key:"render",value:function(){return l.a.createElement("div",{className:"row nextupAddsong border"},l.a.createElement("div",{className:"col-6 border-right"},null!==this.state.playlist?l.a.createElement("div",{className:"nextup"},l.a.createElement("h3",null,"Next up: ",this.state.nextup[0]," (",this.state.nextup[1],")"),l.a.createElement("label",null,"Playlist name: ",this.state.playlist[0]),l.a.createElement(w.a,{striped:!0,border:!0},l.a.createElement("thead",null,l.a.createElement("th",null,"#"),l.a.createElement("th",null,"Song"),l.a.createElement("th",null,"Artist"),l.a.createElement("th",null,"Album"),l.a.createElement("th",null,"Duration")),l.a.createElement("tbody",null,this.state.tracklist.map((function(e,t){return l.a.createElement("tr",null,l.a.createElement("td",null,t+1),l.a.createElement("td",null,e[0]),l.a.createElement("td",null,e[1]),l.a.createElement("td",null,e[2]),l.a.createElement("td",null,e[3]))}))))):l.a.createElement("h2",{className:"nextup"},"[No playlist selected]")),l.a.createElement("div",{className:"col-6 "},l.a.createElement("h2",{div:!0,className:"nextup"},"Add song to playlist")))}}]),a}(l.a.Component),C=(a(65),function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this)).getMusicInfo=function(){console.log("Fetching playback info..."),fetch("/getplayback").then((function(e){return e.json().then((function(e){console.log("res is:",e),null!==e&&void 0!==e&&(console.log("Fetched!"),n.setState({item:e.item,refreshToggled:!1,playback:e.is_playing}))}))}))},n.playpausePlayback=function(e){console.log("Playing/pausing playback..."),fetch("/"+e).then((function(e){return e.json().then((function(e){null!==e&&(console.log("Done!: ",e),n.setState({playbackCommandtrigger:!1}))}))}))},n.changePlaybackNext=function(){console.log("Changing playback..."),fetch("/next").then((function(e){return e.json().then((function(e){null!==e?(console.log("Fetched!: ",e),n.setState({changePlaybackTriggerNext:!1}),console.log("Waiting for spotify to change song..."),setTimeout((function(){n.setState({refreshToggled:!0})}),1e3)):alert("Error from spotify")}))}))},n.changePlaybackPrevious=function(e){console.log("Changing playback..."),fetch("/previous").then((function(e){return e.json().then((function(e){null!==e?(console.log("Fetched!: ",e),n.setState({changePlaybackTriggerPrevious:!1}),console.log("Waiting for spotify to change song..."),setTimeout((function(){n.setState({refreshToggled:!0})}),1e3)):alert("Error from spotify")}))}))},n.getSelectedPlaylist=function(e){console.log("Got selected playlist in dashboard: ",e),n.setState({playlistDisplay:e})},n.state={user:null,loggedIn:!1,item:null,refreshToggled:!1,playbackCommandtrigger:!1,changePlaybackTriggerNext:!1,changePlaybackTriggerPrevious:!1,changePlayback:null,playback:null,playlistDisplay:null},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){this.props.user!==this.state.user&&null!==this.props.user&&(this.setState({user:this.props.user,loggedIn:!0}),this.getMusicInfo()),this.state.refreshToggled&&(console.log("Refreshed"),this.getMusicInfo()),this.state.playbackCommandtrigger&&(console.log("Triggered Play/pause"),!0===this.state.playback?(console.log("play"),this.playpausePlayback("play")):(console.log("pause"),this.playpausePlayback("pause"))),this.state.changePlaybackTriggerNext&&(console.log("next song"),this.changePlaybackNext()),this.state.changePlaybackTriggerPrevious&&(console.log("previous song"),this.changePlaybackPrevious())}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"row"},l.a.createElement("div",{id:"mygroups",className:"col-2 border"},l.a.createElement("div",{className:"row justify-content-center"},l.a.createElement("h2",null,"My groups"),l.a.createElement(S,{user:this.state.user,getplaylist:this.getSelectedPlaylist}))),l.a.createElement("div",{className:"col-7"},l.a.createElement("div",{className:"row nowplaying border"},l.a.createElement("div",{className:"col-6"},null===this.state.item||void 0===this.state.item?l.a.createElement("div",null,l.a.createElement("h2",null,"Now Playing: [Nothing is playing]"),l.a.createElement("button",{className:"btn btn-warning",onClick:function(){return e.setState({refreshToggled:!0})}},"Refresh")):l.a.createElement("div",null,l.a.createElement("h2",null,"Now Playing:"),l.a.createElement("h5",null,this.state.item.name),l.a.createElement("h6",null,"Artist: ",this.state.item.artists[0].name),l.a.createElement("h6",null,"Album: ",this.state.item.album.name),l.a.createElement("button",{className:"btn btn-primary",onClick:function(){return e.setState({changePlaybackTriggerPrevious:!0})}},"Previous"),l.a.createElement("button",{className:"btn btn-warning",onClick:function(){return e.setState({refreshToggled:!0})}},"Refresh"),this.state.playback?l.a.createElement("button",{className:"btn btn-danger",onClick:function(){return e.setState({playbackCommandtrigger:!0,playback:!1})}},"Pause"):l.a.createElement("button",{className:"btn btn-success",onClick:function(){return e.setState({playbackCommandtrigger:!0,playback:!0})}},"Play"),l.a.createElement("button",{className:"btn btn-primary",onClick:function(){return e.setState({changePlaybackTriggerNext:!0})}},"Next"))),l.a.createElement("div",{className:"col-6"},null===this.state.item||void 0===this.state.item?l.a.createElement("h2",null):l.a.createElement("div",null,l.a.createElement("img",{src:"".concat(this.state.item.album.images[1].url),alt:"Cover"})))),l.a.createElement("div",null,l.a.createElement(N,{playlist:this.state.playlistDisplay}))),l.a.createElement("div",{id:"chat",className:"col-3 border"},l.a.createElement("h2",null,"Chat")))}}]),a}(l.a.Component)),j=(a(66),function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).state={loggedIn:!1,userState:null},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;console.log("fetching getUser..."),fetch("/getUser").then((function(t){return t.json().then((function(t){t!==e.state.userState&&(console.log("Fetched!"),e.setState({userState:t}))}))}))}},{key:"render",value:function(){return l.a.createElement("div",{className:"App"},l.a.createElement(f,{user:this.state.userState}),l.a.createElement("div",{className:"container-fluid"},l.a.createElement(C,{user:this.state.userState})))}}]),a}(l.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(j,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[51,1,2]]]);
//# sourceMappingURL=main.c84b17e4.chunk.js.map